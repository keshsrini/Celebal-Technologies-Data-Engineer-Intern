SELECT H.HACKER_ID, H.NAME, SUM(MAX_SCORE) AS TOTAL
FROM HACKERS H
JOIN (
    SELECT S.HACKER_ID, S.CHALLENGE_ID, MAX(S.SCORE) AS MAX_SCORE
    FROM SUBMISSIONS S
    GROUP BY S.HACKER_ID, S.CHALLENGE_ID
) MS ON H.HACKER_ID = MS.HACKER_ID
GROUP BY H.HACKER_ID, H.NAME
HAVING TOTAL > 0
ORDER BY TOTAL DESC, H.HACKER_ID;
